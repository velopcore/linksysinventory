<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Linksys Inventory System</title>

<style>
body { font-family: system-ui; margin:12px; background:#f7f8fb; }
.login-box, .app { max-width:1100px; margin:auto; background:#fff; padding:12px; border-radius:8px; border:1px solid #ddd; }
.hidden { display:none; }
.container { display:flex; gap:12px; }
.left, .right { padding:10px; border:1px solid #eee; border-radius:6px; background:#fff; }
.left { flex:2; }
.right { flex:1; }
label { font-weight:600; margin-top:8px; display:block; }
input, button { width:100%; padding:8px; margin-top:4px; }
button.primary { background:#0366d6; color:#fff; border:none; }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #ddd; padding:6px; font-size:13px; }
th { background:#fafafa; }
.upper { text-transform:uppercase; }
</style>
</head>

<body>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
  <h2>üîê Linksys Inventory Login</h2>
  <label>Username</label>
  <input id="loginUser">
  <label>Password</label>
  <input id="loginPass" type="password">
  <button id="btnLogin" class="primary">Login</button>
</div>

<!-- APP -->
<div class="app hidden" id="app">
  <h2>Linksys Inventory System</h2>

  <div class="container">
    <div class="left">
      <label>Brand</label><input id="fBrand" class="upper">
      <label>Model Number</label><input id="fModel" class="upper">
      <label>Serial Number</label><input id="fSerial" class="upper">
      <label>Date Received</label><input id="fDate">
      <label>Location</label><input id="fLocation" class="upper">
      <label>Tracking Number</label><input id="fTracking" class="upper">
      <label>Remarks</label><input id="fRemarks" class="upper">
      <button id="btnAdd" class="primary">Add Item</button>
    </div>

    <div class="right">
      <label>Import CSV</label>
      <input type="file" id="fileImport" accept=".csv">
      <button id="btnImport">Import</button>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Brand</th><th>Model Number</th><th>Serial Number</th>
        <th>Date Received</th><th>Location</th>
        <th>Tracking Number</th><th>Remarks</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbyQMK6uKZ2HFz5IReZWeQPzyMIS37agBBhOCcrwaN39U5vnOLYAFC05FrwuUuc6mrpxeQ/exec";

const USERS = {
  dennis:"Th3password!",
  carlo:"Concentrix9!",
  edmar:"Asdfg12345!",
  van:"P1nkR@nger!",
  viewer:"viewer"
};

let inventory=[];

const el=id=>document.getElementById(id);

/* LOGIN */
el("btnLogin").onclick=()=>{
  const u=el("loginUser").value;
  const p=el("loginPass").value;
  if(USERS[u]!==p){ alert("Invalid login"); return; }
  el("loginBox").classList.add("hidden");
  el("app").classList.remove("hidden");
};

/* ADD ITEM */
function capture(){
  return {
    "Brand":el("fBrand").value,
    "Model Number":el("fModel").value,
    "Serial Number":el("fSerial").value,
    "Date Received":el("fDate").value,
    "Location":el("fLocation").value,
    "Tracking Number":el("fTracking").value,
    "Remarks":el("fRemarks").value
  };
}

function addRow(item){
  inventory.push(item);
  const tr=document.createElement("tr");
  Object.values(item).forEach(v=>{
    const td=document.createElement("td");
    td.textContent=v;
    tr.appendChild(td);
  });
  el("tbody").appendChild(tr);
}

el("btnAdd").onclick=()=>{
  const item=capture();
  addRow(item);
  fetch(SHEET_URL,{
    method:"POST",
    mode:"no-cors",
    headers:{ "Content-Type":"text/plain" },
    body:JSON.stringify({ ...item, Type:"inventory" })
  });
};

/* IMPORT (SIMPLE & RELIABLE) */
el("btnImport").onclick=()=>{
  const f=el("fileImport").files[0];
  if(!f) return alert("Select CSV file");

  const reader=new FileReader();
  reader.onload=e=>{
    const lines=e.target.result.split(/\r?\n/).filter(l=>l.trim());
    for(let i=1;i<lines.length;i++){
      const c=lines[i].split(",").map(x=>x.replace(/^"|"$/g,""));
      const item={
        "Brand":c[0]||"",
        "Model Number":c[1]||"",
        "Serial Number":c[2]||"",
        "Date Received":c[3]||"",
        "Location":c[4]||"",
        "Tracking Number":c[5]||"",
        "Remarks":c[6]||""
      };
      addRow(item);
      fetch(SHEET_URL,{
        method:"POST",
        mode:"no-cors",
        headers:{ "Content-Type":"text/plain" },
        body:JSON.stringify({ ...item, Type:"inventory" })
      });
    }
    alert("Import completed");
  };
  reader.readAsText(f);
};
</script>

</body>
</html>
